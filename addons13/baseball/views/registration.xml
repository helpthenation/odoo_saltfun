<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

        <record id="view_baseball_registration_kanban" model="ir.ui.view">
            <field name="name">baseball.registration.kanban</field>
            <field name="model">baseball.registration</field>
            <field name="arch" type="xml" >
                <kanban class="o_res_partner_kanban" default_group_by="stage_id" on_create="quick_create" quick_create_view="baseball.quick_create_registration_form" examples="Membership" group_create="0">
                    <field name="id"/>
                    <field name="member_id"/>
                    <field name="season_id"/>
                    <field name="category_id"/>
                    <field name="image_128"/>
                    <field name="fee_to_pay"/>
                    <field name="fee_paid"/>
                    <field name="to_be_paid"/>
                    <field name="currency_id"/>
                    <field name="is_certificate"/>
                    <!-- <progressbar field="category_id"/> -->
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="{{!selection_mode ? 'oe_kanban_color_' + kanban_getcolor(record.category_id.raw_value) : ''}} oe_kanban_global_click">
                                <div class="o_kanban_image">
                                    <img t-att-src="kanban_image('res.partner', 'image_128', record.member_id.raw_value)" alt="test" class="o_image_64_contain"/>
                                </div>
                                <div class="oe_kanban_details">
                                    <strong class="o_kanban_record_title oe_partner_heading"><field name="member_id"/></strong>
                                    <div class="o_kanban_tags_section oe_kanban_partner_categories"/>
                                    <ul>
                                        <li t-if="record.category_id.raw_value"><field name="category_id"/></li>
                                        <li t-if="record.season_id.raw_value"><field name="season_id"/></li>
                                        <!-- <li t-if="record.email.raw_value" class="o_text_overflow"><field name="email"/></li> -->
                                    </ul>
                                </div>
                                <div class="oe_kanban_partner_links">
                                </div>
                                <div class="o_dropdown_kanban dropdown">
                                    <a role="button" class="dropdown-toggle o-no-caret btn" data-toggle="dropdown" data-display="static" href="#" aria-label="Dropdown menu" title="Dropdown menu">
                                        <span class="fa fa-ellipsis-v"/>
                                    </a>
                                    <div class="dropdown-menu" role="menu">
                                        <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                                        <a t-if="!record.is_certificate.raw_value" role="menuitem" type="object" name="test" class="dropdown-item">Add medical Certificate</a>
                                        <a t-if="record.to_be_paid.value&gt;0" role="menuitem" name="add_payment" type="object" class="dropdown-item">Add payment</a>
                                    </div>
                                </div>
                                <div class="o_kanban_record_bottom" t-if="!selection_mode">
                                    <div class="oe_kanban_bottom_left">
                                        <span t-if="record.to_be_paid.value&gt;0" class="badge badge-pill"><field name="to_be_paid"/></span>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <button t-if="!record.is_certificate.raw_value" type="object" name="test" class="btn btn-primary">
                                            <i class="fa fa-medkit" role="img" aria-label="Add medical record"/>
                                        </button>
                                        <button t-if="record.to_be_paid.value&gt;0" type="object" name="add_payment" class="btn btn-primary">
                                            <i class="fa fa-money" role="img" aria-label="Add payment"/>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>



                

        <record id="view_baseball_registration_tree" model="ir.ui.view">
            <field name="name">baseball.registration.tree</field>
            <field name="model">baseball.registration</field>
            <field name="arch" type="xml" >
                <tree>
                    <field name="season_id" required="1" options="{'no_create_edit': True}"/>
                    <field name="is_registered"/>
                    <field name="is_certificate"/>
                    <button class="oe_read_only" type="object" name="action_download_certificate"  string="Download Certificate" icon="fa-download" attrs="{'invisible': ['|', ('certificate_id','=',False), ('is_certificate', '=', False)]}"/>
                    <field class="oe_edit_only" name="certificate_id" context="{'default_res_id': id, 'default_res_model': 'baseball.registration'}" domain="[('res_model', '=', 'baseball.registration'), '|', ('res_id', '=', 0), ('res_id', '=', id)]"/>
                    <field name="category_id" required="1"/>
                    <field name="fee_to_pay"/>
                    <field name="fee_paid"/>
                    <field name="payment_date"/>
                </tree>
            </field>
        </record>


        <record id="view_baseball_registration_form" model="ir.ui.view">
            <field name="name">baseball.registration.form</field>
            <field name="model">baseball.registration</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button type="object" name="add_payment"  string="Add payment" attrs="{'invisible': [('to_be_paid','=', 0)]}"/>
                        <field name="stage_id" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}"/>
                    </header>
                    <sheet>
                        <field name="image_1920" widget="image" class="oe_avatar" options="{&quot;preview_image&quot;: &quot;image_128&quot;}"/>
                        <h1>
                            <field name="member_id"/>
                        </h1>
                        <group>
                            <group>
                                <field name="category_id"/>
                                <field name="season_id"/>
                            </group>
                            <group>
                                <field name="is_registered"/>
                                <field name="is_certificate"/>
                                <field name="fee_to_pay"/>
                                <field name="to_be_paid"/>
                                <field name="fee_paid"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="payment_date"/>
                            </group>
                        </group>
                        <label for="payment_ids"/>
                        <field name="payment_ids" readonly="1">
                            <tree>
                                <field name="payment_type"/>
                                <field name="amount"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="payment_date"/>
                                <field name="communication"/>
                                <field name="state"/>
                            </tree>
                        </field>
                    </sheet>
                    <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>

        <record id="quick_create_registration_form" model="ir.ui.view">
            <field name="name">quick.baseball.registration.form</field>
            <field name="model">baseball.registration</field>
            <field name="priority">1000</field>
            <field name="arch" type="xml">
                <form>
                    <group>
                        <field name="member_id"/>
                        <field name="category_id" options="{'no_open': True,'no_create': True}"/>
                    </group>
                </form>
            </field>
        </record>


        <record model="ir.actions.act_window" id="baseball_list_registration">
            <field name="name">Memberships</field>
            <field name="res_model">baseball.registration</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="context">{'search_default_current_members':1}</field>
        </record>


        <menuitem id="menu_registration_management" name="Membership"
                sequence="0"
                  parent="menu_management"
                  action="baseball_list_registration"/>

	</data>
</odoo>

