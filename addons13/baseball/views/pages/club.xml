<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

<template id="website.contactus" name="Contact us" page="True">
    <t t-call="website.layout">
      <div id="wrap">
        <div class="oe_structure"/>
        <div class="container">
          <div class="panel panel-default">
            <div class="panel-heading">
            <h1 class="panel-title">Contact</h1>
            </div>
            <div class="row panel-body">


                <div class="col-md-8">

                  <t t-set="board" t-value="request.env['res.partner'].sudo().search([('main_club_role_id','!=',False), ('main_club_role_id','!=',request.env.ref('baseball.roles_members').id ),('main_club_role_id.published','=',True)]).sorted(lambda r: r.main_club_role_id.sequence)"/>
                  <t t-set="teams" t-value="request.env['baseball.teams'].sudo().search([('is_opponent','=',False), ])"/>

                  <div >
                    <h4>Comité</h4>
                    <table class="table table-contact table-condensed table-striped">
                      <tbody>
                        <t t-foreach="board or []" t-as="member">
                          <tr>
                            <td class="col-md-2 hidden-xs"><t t-if="member.image">
                              <img class="maxed img img-responsive" style="width: 50px" t-att-src="'data:image/png;base64,'+member.sudo().image_small"/>
                            </t></td>
                            <td class="col-md-2 col-xs-2"><span t-field="member.name"/></td>
                            <td class="col-md-2 hidden-xs"><span t-field="member.main_club_role_id.name"/></td>
                            <td class="col-md-4 col-xs-4">
                              <a t-attf-href="tel:#{member.mobile}"><span t-field="member.mobile"/></a><br/>
                              <a t-attf-href="tel:#{member.phone}"><span t-field="member.phone"/></a><br/>
                              <a t-attf-href="mailto:#{member.email}"><span t-field="member.email"/></a><br/>
                             </td>
                            <td class="col-md-4 hidden-xs"><t t-if="member.main_club_role_id.address_website"><span t-field="member.street"/> <span t-field="member.street2"/><br/><span t-field="member.zip"/> <span t-field="member.city"/></t></td>
                          </tr>
                        </t>
                      </tbody>
                    </table>
                    <h4>Contact équipes</h4>
                  <t t-set="season" t-value="request.env['baseball.season'].sudo().get_current_season()"/>
                    <table class="table table-contact table-condensed table-striped">
                      <tbody>
                        <t t-foreach="teams or []" t-as="team">
                          <tr>
                              <td class="col-md-12 col-xs-6" colspan="4"><h5 t-field="team.name"/></td>
                          </tr>

                          <t t-foreach="team.responsible_ids" t-as="member">
                            <tr>
                              <td class="col-md-2 hidden-xs"><t t-if="member.image">
                                <img class="maxed img img-responsive" style="width: 50px" t-att-src="'data:image/png;base64,'+member.sudo().image_small"/>
                              </t></td>
                              <td class="col-md-2 col-xs-2"><span t-field="member.name"/></td>
                              <td class="col-md-2 col-xs-2">Responsable</td>
                              <td class="col-md-4 col-xs-4">
                                <a t-attf-href="tel:#{member.mobile}"><span t-field="member.mobile"/></a><br/>
                                <a t-attf-href="tel:#{member.phone}"><span t-field="member.phone"/></a><br/>
                                <a t-attf-href="mailto:#{member.email}"><span t-field="member.email"/></a><br/>
                               </td>
                            </tr>
                          </t>
                          <t t-foreach="team.coaches_ids" t-as="member">
                            <tr>
                              <td class="col-md-2 hidden-xs"><t t-if="member.image">
                                <img class="maxed img img-responsive" style="width: 50px" t-att-src="'data:image/png;base64,'+member.sudo().image_small"/>
                              </t></td>
                              <td class="col-md-2 col-xs-2"><span t-field="member.name"/></td>
                              <td class="col-md-2 col-xs-2">Coach</td>
                              <td class="col-md-4 col-xs-4">
                                <a t-attf-href="tel:#{member.mobile}"><span t-field="member.mobile"/></a><br/>
                                <a t-attf-href="tel:#{member.phone}"><span t-field="member.phone"/></a><br/>
                                <a t-attf-href="mailto:#{member.email}"><span t-field="member.email"/></a><br/>
                               </td>
                            </tr>
                          </t>
                        </t>
                      </tbody>
                    </table>
                    <t t-if="res_company.partner_id.bank_ids">
                      <h4>Informations bancaires</h4>
                      <table class="table table-contact">
                        <tbody>
                          <t t-foreach="res_company.partner_id.bank_ids" t-as="bank_account">
                            <tr>
                              <td><span t-field="bank_account.partner_id.name"/></td>
                              <td><span t-field="bank_account.bank_id.name"/></td>
                              <td><span t-field="bank_account.acc_number"/></td>
                            </tr>
                          </t>
                        </tbody>
                      </table>  
                    </t>
                  </div>
                  <br/>
                  <div class="oe_structure">
                      <div>
                          <p>Contactez pour toute question concernant le club.</p>
                      </div>
                  </div>
                  <div class="text-center mt64" name="mail_button">
                      <a t-attf-href="mailto:{{ res_company.email }}" class="btn btn-primary">Envoyez nous un email</a>
                  </div>
                </div>
                <div class="col-md-4 mb32">
                    <t t-call="website.company_description"/>
                </div>
            </div>
          </div>
        </div>
        <div class="oe_structure"/>
      </div>
    </t>
</template>


<template id="website.company_description" name="Company Description">
    <address itemscope="itemscope" itemtype="http://schema.org/Organization">
        <!-- TODO widget contact must add itemprop attributes -->
        <h4>Siège</h4>

        <div t-field="res_company.partner_id" t-field-options='{
                "widget": "contact",
                "fields": ["name", "address", "phone", "email"]}'/>
    </address>
    <address itemscope="itemscope" itemtype="http://schema.org/Organization">
        <h4>Terrain</h4>
        <div t-field="res_company.partner_id.field_street"/>
        <div t-field="res_company.partner_id.field_zip"/>
        <div t-field="res_company.partner_id.field_city"/>
    </address>
     <a t-att-href="res_company.google_map_link(field=True)" target="_BLANK">
        <img class="thumbnail img-responsive" t-att-src="res_company.google_map_img(field=True)" />
    </a>
</template>


  </data>
</odoo>